library search_test;

import 'package:nhentai/data_model.dart';
import 'package:test/expect.dart';
import 'package:test/scaffolding.dart';

import 'book_test.dart' as book_test;

const bookTitleJson = '{"english":"[Puu no Puupuupuu (Puuzaki Puuna)] Hitozukiai ga Nigate na Miboujin no Yukionna-san to Noroi no Yubiwa [English]","japanese":"[ぷぅのぷぅぷぅぷぅ (ぷぅ崎ぷぅ奈)] 人付き合いが苦手な未亡人の雪女さんと呪いの指輪 [英訳]","pretty":"Hitozukiai ga Nigate na Miboujin no Yukionna-san to Noroi no Yubiwa"}';

const titleEnglish = '[Puu no Puupuupuu (Puuzaki Puuna)] Hitozukiai ga Nigate na Miboujin no Yukionna-san to Noroi no Yubiwa [English]';
const titleJapanese = '[ぷぅのぷぅぷぅぷぅ (ぷぅ崎ぷぅ奈)] 人付き合いが苦手な未亡人の雪女さんと呪いの指輪 [英訳]';
const titlePretty = 'Hitozukiai ga Nigate na Miboujin no Yukionna-san to Noroi no Yubiwa';

const imagesJson = '{"pages":[{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1811}],"cover":{"t":"j","w":350,"h":498},"thumbnail":{"t":"j","w":250,"h":356}}';

const pagesCount = 71;
const firstPageType = ImageType.jpeg;
const firstPageWidth = 1280;
const firstPageHeight = 1819;
const firstPageFilename = '1.jpg';
const firstPageUrl = 'https://i.nhentai.net/galleries/$mediaId/1.jpg';
const firstPageThumbnailUrl = 'https://t.nhentai.net/galleries/$mediaId/1.jpg';
const coverType = ImageType.jpeg;
const coverWidth = 350;
const coverHeight = 498;
const coverFilename = 'cover.jpg';
const coverUrl = 'https://t.nhentai.net/galleries/$mediaId/cover.jpg';
const thumbnailType = ImageType.jpeg;
const thumbnailWidth = 250;
const thumbnailHeight = 356;
const thumbnailFilename = 'thumb.jpg';
const thumbnailUrl = 'https://t.nhentai.net/galleries/$mediaId/thumb.jpg';

const tagsJson = '[{"id":12227,"type":"language","name":"english","url":"/language/english/","count":87222},{"id":17249,"type":"language","name":"translated","url":"/language/translated/","count":146174},{"id":90671,"type":"parody","name":"original","url":"/parody/original/","count":38470},{"id":103003,"type":"group","name":"puu no puupuupuu","url":"/group/puu-no-puupuupuu/","count":21},{"id":109930,"type":"tag","name":"domination loss","url":"/tag/domination-loss/","count":300},{"id":35763,"type":"tag","name":"sole male","url":"/tag/sole-male/","count":81948},{"id":2937,"type":"tag","name":"big breasts","url":"/tag/big-breasts/","count":125874},{"id":29859,"type":"tag","name":"blowjob","url":"/tag/blowjob/","count":49599},{"id":32996,"type":"tag","name":"deepthroat","url":"/tag/deepthroat/","count":4058},{"id":15408,"type":"tag","name":"femdom","url":"/tag/femdom/","count":21000},{"id":3666,"type":"tag","name":"garter belt","url":"/tag/garter-belt/","count":8913},{"id":1207,"type":"tag","name":"milf","url":"/tag/milf/","count":29047},{"id":20617,"type":"tag","name":"mind control","url":"/tag/mind-control/","count":11946},{"id":24380,"type":"tag","name":"pantyhose","url":"/tag/pantyhose/","count":17677},{"id":35762,"type":"tag","name":"sole female","url":"/tag/sole-female/","count":90933},{"id":24201,"type":"tag","name":"stockings","url":"/tag/stockings/","count":76952},{"id":25794,"type":"tag","name":"widow","url":"/tag/widow/","count":895},{"id":20905,"type":"tag","name":"full color","url":"/tag/full-color/","count":43715},{"id":27473,"type":"tag","name":"mosaic censorship","url":"/tag/mosaic-censorship/","count":31541},{"id":33172,"type":"category","name":"doujinshi","url":"/category/doujinshi/","count":274640},{"id":113479,"type":"artist","name":"zeroshiki kouichi","url":"/artist/zeroshiki-kouichi/","count":15},{"id":13720,"type":"tag","name":"nakadashi","url":"/tag/nakadashi/","count":55015},{"id":2633,"type":"tag","name":"leg lock","url":"/tag/leg-lock/","count":2185},{"id":25871,"type":"tag","name":"lingerie","url":"/tag/lingerie/","count":9941}]';

const tagCount = 24;

const bookJson = '{"id":366224,"media_id":"1961972","title":$bookTitleJson,"images":$imagesJson,"scanlator":"","upload_date":1626598798,"tags":$tagsJson,"num_pages":71,"num_favorites":90492}';

const bookId = 366224;
const mediaId = 1961972;

const searchResultJson = '{"result":[{"id":366224,"media_id":"1961972","title":{"english":"[Puu no Puupuupuu (Puuzaki Puuna)] Hitozukiai ga Nigate na Miboujin no Yukionna-san to Noroi no Yubiwa [English]","japanese":"[ぷぅのぷぅぷぅぷぅ (ぷぅ崎ぷぅ奈)] 人付き合いが苦手な未亡人の雪女さんと呪いの指輪 [英訳]","pretty":"Hitozukiai ga Nigate na Miboujin no Yukionna-san to Noroi no Yubiwa"},"images":{"pages":[{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1819},{"t":"j","w":1280,"h":1811}],"cover":{"t":"j","w":350,"h":498},"thumbnail":{"t":"j","w":250,"h":356}},"scanlator":"","upload_date":1626598798,"tags":[{"id":12227,"type":"language","name":"english","url":"/language/english/","count":87222},{"id":17249,"type":"language","name":"translated","url":"/language/translated/","count":146174},{"id":90671,"type":"parody","name":"original","url":"/parody/original/","count":38470},{"id":103003,"type":"group","name":"puu no puupuupuu","url":"/group/puu-no-puupuupuu/","count":21},{"id":109930,"type":"tag","name":"domination loss","url":"/tag/domination-loss/","count":300},{"id":35763,"type":"tag","name":"sole male","url":"/tag/sole-male/","count":81948},{"id":2937,"type":"tag","name":"big breasts","url":"/tag/big-breasts/","count":125874},{"id":29859,"type":"tag","name":"blowjob","url":"/tag/blowjob/","count":49599},{"id":32996,"type":"tag","name":"deepthroat","url":"/tag/deepthroat/","count":4058},{"id":15408,"type":"tag","name":"femdom","url":"/tag/femdom/","count":21000},{"id":3666,"type":"tag","name":"garter belt","url":"/tag/garter-belt/","count":8913},{"id":1207,"type":"tag","name":"milf","url":"/tag/milf/","count":29047},{"id":20617,"type":"tag","name":"mind control","url":"/tag/mind-control/","count":11946},{"id":24380,"type":"tag","name":"pantyhose","url":"/tag/pantyhose/","count":17677},{"id":35762,"type":"tag","name":"sole female","url":"/tag/sole-female/","count":90933},{"id":24201,"type":"tag","name":"stockings","url":"/tag/stockings/","count":76952},{"id":25794,"type":"tag","name":"widow","url":"/tag/widow/","count":895},{"id":20905,"type":"tag","name":"full color","url":"/tag/full-color/","count":43715},{"id":27473,"type":"tag","name":"mosaic censorship","url":"/tag/mosaic-censorship/","count":31541},{"id":33172,"type":"category","name":"doujinshi","url":"/category/doujinshi/","count":274640},{"id":113479,"type":"artist","name":"zeroshiki kouichi","url":"/artist/zeroshiki-kouichi/","count":15},{"id":13720,"type":"tag","name":"nakadashi","url":"/tag/nakadashi/","count":55015},{"id":2633,"type":"tag","name":"leg lock","url":"/tag/leg-lock/","count":2185},{"id":25871,"type":"tag","name":"lingerie","url":"/tag/lingerie/","count":9941}],"num_pages":71,"num_favorites":90492},{"id":297974,"media_id":"1553654","title":{"english":"Joshi Kōsei Rich Thots","japanese":"Joshi Kōsei Rich Thots","pretty":"Joshi Kōsei Rich Thots"},"images":{"pages":[{"t":"p","w":1280,"h":898},{"t":"p","w":1280,"h":2042},{"t":"p","w":1280,"h":1817},{"t":"p","w":1280,"h":1817},{"t":"p","w":1280,"h":1280},{"t":"p","w":1280,"h":1817},{"t":"p","w":1280,"h":947},{"t":"p","w":1280,"h":902},{"t":"p","w":1280,"h":902},{"t":"p","w":1280,"h":902},{"t":"p","w":1280,"h":1817},{"t":"p","w":1280,"h":902},{"t":"p","w":1273,"h":2160},{"t":"p","w":1280,"h":1468},{"t":"p","w":1280,"h":1817},{"t":"p","w":1280,"h":1817},{"t":"p","w":1280,"h":1817},{"t":"p","w":1280,"h":1817},{"t":"p","w":1280,"h":1817},{"t":"p","w":1280,"h":1817},{"t":"p","w":1280,"h":1817},{"t":"p","w":1280,"h":902},{"t":"p","w":1280,"h":1812},{"t":"p","w":1280,"h":1812},{"t":"p","w":1280,"h":1812},{"t":"p","w":1280,"h":1812},{"t":"p","w":1280,"h":905},{"t":"p","w":1280,"h":1812},{"t":"p","w":1280,"h":905},{"t":"p","w":1280,"h":905},{"t":"p","w":1280,"h":1812},{"t":"p","w":1280,"h":1812},{"t":"p","w":1280,"h":1812},{"t":"p","w":1280,"h":1812},{"t":"p","w":1280,"h":902},{"t":"p","w":1280,"h":1817},{"t":"p","w":1280,"h":1817},{"t":"p","w":1280,"h":873},{"t":"p","w":1280,"h":902},{"t":"p","w":1280,"h":1812},{"t":"p","w":1280,"h":1811},{"t":"p","w":1280,"h":902},{"t":"p","w":1280,"h":1817},{"t":"p","w":1280,"h":1817},{"t":"p","w":1280,"h":1812},{"t":"p","w":1280,"h":739},{"t":"p","w":1280,"h":1812},{"t":"p","w":1280,"h":1812},{"t":"p","w":1280,"h":1812},{"t":"p","w":1280,"h":1812},{"t":"p","w":1280,"h":1812},{"t":"p","w":1280,"h":1812},{"t":"p","w":1280,"h":1812},{"t":"p","w":1280,"h":1811},{"t":"p","w":1280,"h":1812}],"cover":{"t":"p","w":350,"h":246},"thumbnail":{"t":"p","w":250,"h":176}},"scanlator":"","upload_date":1579256364,"tags":[{"id":12227,"type":"language","name":"english","url":"/language/english/","count":69378},{"id":17249,"type":"language","name":"translated","url":"/language/translated/","count":109734},{"id":32299,"type":"group","name":"candy club","url":"/group/candy-club/","count":30},{"id":14713,"type":"artist","name":"sky","url":"/artist/sky/","count":32},{"id":15782,"type":"tag","name":"crossdressing","url":"/tag/crossdressing/","count":12931},{"id":12695,"type":"tag","name":"prostitution","url":"/tag/prostitution/","count":5613},{"id":32341,"type":"tag","name":"shotacon","url":"/tag/shotacon/","count":39737},{"id":81707,"type":"tag","name":"beauty mark","url":"/tag/beauty-mark/","count":3284},{"id":2937,"type":"tag","name":"big breasts","url":"/tag/big-breasts/","count":103273},{"id":15408,"type":"tag","name":"femdom","url":"/tag/femdom/","count":17418},{"id":1033,"type":"tag","name":"handjob","url":"/tag/handjob/","count":5884},{"id":15785,"type":"tag","name":"harem","url":"/tag/harem/","count":7615},{"id":9162,"type":"tag","name":"masturbation","url":"/tag/masturbation/","count":9228},{"id":15749,"type":"tag","name":"oil","url":"/tag/oil/","count":322},{"id":25614,"type":"tag","name":"paizuri","url":"/tag/paizuri/","count":22785},{"id":10314,"type":"tag","name":"schoolgirl uniform","url":"/tag/schoolgirl-uniform/","count":56168},{"id":26952,"type":"tag","name":"tall girl","url":"/tag/tall-girl/","count":1540},{"id":15348,"type":"tag","name":"ffm threesome","url":"/tag/ffm-threesome/","count":17957},{"id":8010,"type":"tag","name":"group","url":"/tag/group/","count":72150},{"id":33172,"type":"category","name":"doujinshi","url":"/category/doujinshi/","count":228729},{"id":29023,"type":"tag","name":"tomgirl","url":"/tag/tomgirl/","count":9618}],"num_pages":55,"num_favorites":26671}],"num_pages":1,"per_page":25}';

const booksCount = 2;
const perPage = 25;
const pages = 1;

void main() {
  group('searchResult parsing test', () {
    final searchResult = Mapper.fromJson<SearchResult>(searchResultJson);

    test('book count', () {
      expect(searchResult.books.length, booksCount);
    });
    test('perPage', () {
      expect(searchResult.perPage, perPage);
    });
    test('pages', () {
      expect(searchResult.pages, pages);
    });

    book_test.run(searchResult.books.first,  
      json: '',
      id: bookId, 
      media: mediaId,
      tagCount: tagCount,
    );

  });
}
